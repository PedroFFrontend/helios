/** @format */

import { useAppSelector } from "@/redux/hooks"
import styles from "./Background.module.css"
import { LegacyRef, useEffect, useRef, useState } from "react"

const zenithColors = [
  "rgba(0,0,12,0)",
  "rgba(2,1,17,0)",
  "rgba(2,1,17,0)",
  "rgba(2,1,17,0)",
  "rgba(32,32,44,0.5)",
  "rgba(64,64,92,.8)",
  "rgb(74,73,105)",
  "rgb(117,122,191)",
  "rgb(130,173,219)",
  "rgb(148,197,248)",
  "rgb(183,234,255)",
  "rgb(144,223,254)",
  "rgb(87,193,235)",
  "rgb(45,145,194)",
  "rgb(36,115,171)",
  "rgb(30,82,142)",
  "rgb(30,82,142)",
  "rgb(21,66,119)",
  "rgba(22,60,82,0.8)",
  "rgba(7,27,38,.5)",
  "rgba(1,10,16,.3)",
  "rgba(9,4,1,0)",
  "rgba(0,0,12,0)",
  "rgba(0,0,12,0)",
]

const horizonColors = [
  "rgba(0,0,12,0)",
  "rgba(25,22,33,.3)",
  "rgba(32,32,44,.8)",
  "rgb(58,58,82)",
  "rgb(81,81,117)",
  "rgb(138,118,171)",
  "rgb(205,130,160)",
  "rgb(234,176,209)",
  "rgb(235,178,177)",
  "rgb(177,181,234)",
  "rgb(148,223,255)",
  "rgb(103,209,251)",
  "rgb(56,163,209)",
  "rgb(36,111,168)",
  "rgb(30,82,142)",
  "rgb(91,121,131)",
  "rgb(157,166,113)",
  "rgb(233,206,93)",
  "rgb(178,99,57)",
  "rgb(47,17,7)",
  "rgb(36,14,3)",
  "rgba(75,29,6,.4)",
  "rgba(21,8,0,0)",
  "rgba(0,0,12,0)",
]

const mountainColors = [
  "#333",
  "#333",
  "#333",
  "rgb(58,58,82)",
  "rgb(81,81,117)",
  "rgb(117,121,170)",
  "rgb(150,138,200)",
  "rgb(205,130,160)",
  "rgb(235,178,177)",
  "rgb(234,176,209)",
  "#f87",
  "#f55",
  "#f55",
  "#f55",
  "#f55",
  "#f87",
  "#d96",
  "rgb(233,206,93)",
  "rgb(178,99,57)",
  "rgb(138,49,57)",
  "rgb(86,54,46)",
  "rgb(55,39,36)",
  "#333",
  "#333",
]

export default function Background() {
  const { location, current, forecast } = useAppSelector(s => s.weather)
  const localDate = location ? new Date(location.localtime) : undefined

  const [hours, setHours] = useState({
    prev: { time: 12, sunrise: 5, sunset: 20, moonrise: 0, moonset: 0 },
    current: { time: 12, sunrise: 5, sunset: 20, moonrise: 0, moonset: 0 },
  })

  const zenithStopRef = useRef<SVGStopElement>(null)
  const horizonStopRef = useRef<SVGStopElement>(null)
  const sunRef = useRef<HTMLDivElement>(null)
  const moonRef = useRef<HTMLDivElement>(null)
  const mountainsRef = useRef<SVGGElement>(null)

  useEffect(() => {
    const localDate = location ? new Date(location.localtime) : undefined
    const hours = localDate ? localDate.getHours() : 12
    const sunrise = Number(forecast?.forecastday[0].astro.sunrise?.slice(0, 2))
    const sunset = Number(forecast?.forecastday[0].astro.sunset?.slice(0, 2)) + 12

    const raw_moonrise = forecast?.forecastday[0].astro.moonrise
    const raw_moonset = forecast?.forecastday[0].astro.moonset

    const moonrise = raw_moonrise ? (raw_moonrise.includes("AM") ? Number(raw_moonrise.slice(0, 2)) : Number(raw_moonrise.slice(0, 2)) + 12) : 0
    const moonset = raw_moonset ? (raw_moonset.includes("AM") ? Number(raw_moonset.slice(0, 2)) : Number(raw_moonset.slice(0, 2)) + 12) : 0

    setHours(s => ({ prev: s.current, current: { time: hours, sunrise, sunset, moonrise, moonset } }))
  }, [location, location?.localtime, forecast?.forecastday])

  useEffect(() => {
    const zenithStop = zenithStopRef.current
    const horizonStop = horizonStopRef.current
    const sun = sunRef.current
    const moon = moonRef.current
    const mountains = mountainsRef.current
    const duration = 3000

    const zenithKeyframes = []
    const horizonKeyframes = []
    const sunKeyframes = []
    const moonKeyframes = []
    const mountainsKeyframes = []

    if (hours.prev.time === hours.current.time) {
      return
    } else if (hours.prev < hours.current) {
      for (let i = 0; i < hours.current.time - hours.prev.time + 1; i++) {
        const h = (hours.prev.time + i) % 24
        zenithKeyframes.push({ stopColor: zenithColors[h] })
        horizonKeyframes.push({ stopColor: horizonColors[h] })
        mountainsKeyframes.push({ fill: mountainColors[h] })
      }
      sunKeyframes.push(
        { rotate: `${((hours.prev.time - hours.prev.sunrise) / (hours.current.sunset - hours.current.sunrise)) * 180}deg` },
        { rotate: `${((hours.current.time - hours.current.sunrise) / (hours.current.sunset - hours.current.sunrise)) * 180}deg` }
      )
      moonKeyframes.push(
        { rotate: `${((hours.prev.time - hours.prev.moonrise) / (hours.prev.moonset - hours.prev.moonrise)) * 180}deg` },
        { rotate: `${((hours.current.time - hours.current.moonrise) / (hours.current.moonset - hours.current.moonrise)) * 180}deg` }
      )
    } else {
      for (let i = 0; i < 24 + hours.current.time - hours.prev.time + 1; i++) {
        const h = (hours.prev.time + i) % 24
        zenithKeyframes.push({ stopColor: zenithColors[h] })
        horizonKeyframes.push({ stopColor: horizonColors[h] })
        mountainsKeyframes.push({ fill: mountainColors[h] })
      }
      sunKeyframes.push(
        { rotate: `${((hours.prev.time - hours.prev.sunrise) / (hours.prev.sunset - hours.prev.sunrise)) * 180}deg` },
        { rotate: `${((hours.current.time - hours.current.sunrise) / (hours.current.sunset - hours.current.sunrise)) * 180 + 360}deg` }
      )
      moonKeyframes.push(
        { rotate: `${((hours.prev.time - hours.prev.moonrise) / (hours.prev.moonset - hours.prev.moonrise)) * 180}deg` },
        { rotate: `${((hours.current.time - hours.current.moonrise) / (hours.current.moonset - hours.current.moonrise)) * 180 + 360}deg` }
      )
    }

    const zenithAnimation = zenithStop?.animate(zenithKeyframes, {
      duration,
      fill: "forwards",
      easing: "ease",
    })
    const horizonAnimation = horizonStop?.animate(horizonKeyframes, {
      duration,
      fill: "forwards",
      easing: "ease",
    })
    const mountainsAnimation = mountains?.animate(mountainsKeyframes, {
      duration,
      fill: "forwards",
      easing: "ease",
    })

    const sunAnimation = sun?.animate(sunKeyframes, {
      duration,
      fill: "forwards",
      easing: "ease",
    })

    const moonAnimation = moon?.animate(moonKeyframes, {
      duration,
      fill: "forwards",
      easing: "ease",
    })

    horizonAnimation?.play()
    zenithAnimation?.play()
    mountainsAnimation?.play()
    sunAnimation?.play()
    moonAnimation?.play()
  }, [hours])

  const ground = (
    <svg version="1.1" viewBox="0 0 174.98 22.307" xmlns="http://www.w3.org/2000/svg">
      <g transform="translate(5.1645 -147.59)">
        <g ref={mountainsRef} fill="#df4542">
          <path d="m9.8564 169.13 72.59-0.15472-35.481-20.166-49.738 12.985z" filter="brightness(0.9)" />
          <path d="m24.127 147.59 29.266 18.791-58.558 1.0967v-9.2622l29.291-10.625" filter="brightness(1.05)" />
          <path d="m79.185 156.1-40.797 9.7434 91.773 3.283-50.976-13.026" filter="brightness(0.8)" />
          <path d="m89.272 167.67 27.776-14.169 49.467 15.111" filter="brightness(0.9)" />
          <path d="m109.29 168.38 33.372-17.751 26.676 11.535v7.6988z" />
          <path d="m147.37 168.68 22.451-18.047-0.47475 18.343z" filter="brightness(1.05)" />
        </g>
        <g>
          <path d="m169.3 168.58-174.46-7.4471 1e-6 8.7711 174.51-0.0331" />
          {/* ^ ground ^ */}
          <path d="m83.358 165.54 0.29967-1.1497 0.31586-0.0395-0.26059-0.14214 0.40272-1.5872 0.15793 0.58434-0.12634 0.10265 0.18162 0.0395 0.37903 1.4293h-0.30007l0.33955 0.15793-0.24479 0.0237 0.28427 0.0869 0.11845 0.49398z" />
          <path d="m82.221 165.5 0.29967-1.1497 0.31586-0.0395-0.26059-0.14214 0.40272-1.5872 0.15793 0.58434-0.12634 0.10265 0.18162 0.0395 0.37903 1.4293h-0.30007l0.33955 0.15793-0.24479 0.0237 0.28427 0.0869 0.11845 0.49398z" />
          <path d="m81.301 165.04 0.29967-1.1497 0.31586-0.0395-0.26059-0.14214 0.40272-1.5872 0.15793 0.58434-0.12634 0.10265 0.18162 0.0395 0.37903 1.4293h-0.30007l0.33955 0.15793-0.24479 0.0237 0.28427 0.0869 0.11845 0.49397z" />
          <path d="m75.381 165.04 0.29967-1.1497 0.31586-0.0395-0.26059-0.14214 0.40272-1.5872 0.15793 0.58434-0.12634 0.10265 0.18162 0.0395 0.37903 1.4293h-0.30007l0.33955 0.15793-0.24479 0.0237 0.28427 0.0869 0.11845 0.49397z" />
          <path d="m77.332 165.14 0.29967-1.1497 0.31586-0.0395-0.26059-0.14214 0.40272-1.5872 0.15793 0.58434-0.12634 0.10265 0.18162 0.0395 0.37903 1.4293h-0.30007l0.33955 0.15793-0.24479 0.0237 0.28427 0.0869 0.11845 0.49397z" />
          <path d="m79.317 164.92 0.40675-1.396 0.42871-0.0479-0.35369-0.1726 0.54659-1.9272 0.21436 0.70954-0.17147 0.12464 0.24651 0.048 0.51444 1.7355h-0.40729l0.46088 0.19177-0.33225 0.0288 0.38583 0.10552 0.16077 0.5998z" />
          <path d="m72.752 165.13 0.58517-2.0084 0.61675-0.0689-0.50883-0.24831 0.78635-2.7726 0.30838 1.0208-0.24668 0.17932 0.35464 0.069 0.74009 2.4967h-0.58594l0.66304 0.27589-0.47799 0.0414 0.55507 0.15181 0.23129 0.86289z" />
          <path d="m68.171 164.92 0.7503-2.5751 0.79079-0.0883-0.65241-0.31838 1.0082-3.555 0.3954 1.3088-0.31629 0.22993 0.45472 0.0885 0.94893 3.2013h-0.75128l0.85014 0.35375-0.61287 0.0531 0.7117 0.19465 0.29656 1.1064z" />
          <path d="m71.43 165.43 0.3059-1.0499 0.32242-0.036-0.266-0.12981 0.41108-1.4494 0.1612 0.53362-0.12895 0.0937 0.18539 0.0361 0.38689 1.3052h-0.3063l0.34661 0.14423-0.24987 0.0216 0.29016 0.0794 0.12091 0.45108z" />
          <path d="m63.81 164.78 0.9265-3.1799 0.97654-0.10904-0.80565-0.39316 1.2451-4.3899 0.48823 1.6162-0.39056 0.28379 0.56151 0.10934 1.1718 3.9531h-0.92771l1.0498 0.43684-0.7568 0.0654 0.87883 0.24048 0.36621 1.3662z" />
          <path d="m60.295 164.68 0.9265-3.1799 0.97654-0.10904-0.80565-0.39316 1.2451-4.3899 0.48823 1.6162-0.39056 0.28379 0.56151 0.10934 1.1718 3.9531h-0.92772l1.0498 0.43684-0.7568 0.0654 0.87882 0.24048 0.36621 1.3662z" />
          <path d="m63.015 164.68 0.63395-2.1758 0.66818-0.0746-0.55125-0.26901 0.85192-3.0038 0.33407 1.1059-0.26724 0.19418 0.38421 0.0748 0.80179 2.7048h-0.63478l0.71832 0.2989-0.51783 0.0447 0.60132 0.16455 0.25058 0.93482z" />
          <path d="m58.143 164.68 0.83385-2.8619 0.87889-0.0981-0.72509-0.35385 1.1206-3.951 0.4394 1.4546-0.3515 0.25541 0.50536 0.0984 1.0546 3.5578h-0.83495l0.94483 0.39316-0.68112 0.0589 0.79094 0.21643 0.32959 1.2296z" />
          <path d="m55.066 164.68 0.83385-2.8619 0.87889-0.0981-0.72509-0.35385 1.1206-3.951 0.4394 1.4546-0.3515 0.25541 0.50536 0.0984 1.0546 3.5578h-0.83495l0.94483 0.39316-0.68112 0.0589 0.79094 0.21643 0.3296 1.2296z" />
          <path d="m52.246 164.68 1.2679-4.3516 1.3364-0.14916-1.1025-0.53803 1.7038-6.0074 0.66811 2.2117-0.53446 0.38835 0.7684 0.14962 1.6036 5.4096h-1.2695l1.4366 0.5978-1.0356 0.0896 1.2026 0.32908 0.50115 1.8696z" />
          <path d="m57.278 164.68 0.58445-2.006 0.61602-0.0688-0.50822-0.24802 0.78542-2.7692 0.30798 1.0195-0.24637 0.17902 0.35421 0.069 0.7392 2.4937h-0.58522l0.66224 0.27557-0.47741 0.0413 0.55438 0.1517 0.23101 0.86184z" />
          <path d="m49.383 164.68 0.85731-2.9424 0.90361-0.10086-0.74548-0.3638 1.1521-4.0621 0.45176 1.4955-0.36139 0.26259 0.51958 0.10117 1.0843 3.6578h-0.85844l0.97141 0.40422-0.70028 0.0606 0.81319 0.22252 0.33887 1.2642z" />
          <path d="m45.297 164.68 0.99411-3.412 1.0478-0.11696-0.86444-0.42185 1.3359-4.7103 0.52385 1.7342-0.41906 0.30449 0.60249 0.11731 1.2573 4.2416h-0.99542l1.1264 0.46872-0.81202 0.0703 0.94295 0.25803 0.39294 1.4659z" />
          <path d="m41.976 164.68 0.81969-2.8133 0.86396-0.0964-0.71277-0.34783 1.1015-3.8838 0.43194 1.4299-0.34553 0.25107 0.49677 0.0967 1.0367 3.4973h-0.82076l0.92878 0.38648-0.66955 0.058 0.7775 0.21276 0.324 1.2087z" />
          <path d="m38.827 164.68 1.2038-4.1316 1.2688-0.14157-1.0468-0.51083 1.6177-5.7038 0.63434 2.1-0.50744 0.36872 0.72956 0.14201 1.5225 5.1362h-1.2054l1.364 0.56758-0.9833 0.0852 1.1418 0.31246 0.47582 1.7751z" />
          <path d="m33.465 164.68 1.3961-4.7918 1.4715-0.16419-1.214-0.59244 1.8762-6.6151 0.73569 2.4354-0.58852 0.42763 0.84613 0.1647 1.7658 5.9568h-1.398l1.5819 0.65826-1.1404 0.0988 1.3243 0.36238 0.55184 2.0587z" />
          <path d="m36.495 164.68 1.1241-3.858 1.1848-0.1322-0.97744-0.47699 1.5106-5.326 0.59232 1.9608-0.47383 0.34429 0.68124 0.13261 1.4217 4.796h-1.1255l1.2737 0.52998-0.91817 0.0795 1.0662 0.29176 0.4443 1.6575z" />
          <path d="m44.403 164.68 0.49706-1.706 0.5239-0.0585-0.43222-0.21092 0.66797-2.3552 0.26193 0.86709-0.20953 0.15224 0.30124 0.0586 0.62867 2.1208h-0.49771l0.56321 0.23437-0.40602 0.0352 0.47148 0.12901 0.19647 0.73297z" />
          <path d="m31.825 163.77 0.49706-1.706 0.5239-0.0585-0.43222-0.21092 0.66797-2.3552 0.26193 0.86709-0.20953 0.15225 0.30124 0.0586 0.62867 2.1208h-0.49771l0.56321 0.23436-0.40602 0.0352 0.47148 0.129 0.19647 0.73297z" />
          <path d="m26.95 163.77 1.0455-3.5883 1.102-0.12305-0.90912-0.44364 1.405-4.9538 0.55093 1.8238-0.44072 0.32024 0.63363 0.12326 1.3223 4.4608h-1.0469l1.1846 0.49294-0.854 0.0741 0.99169 0.27132 0.41325 1.5417z" />
          <path d="m23.52 163.77 0.83451-2.8642 0.87958-0.0982-0.72566-0.35411 1.1214-3.954 0.43975 1.4557-0.35178 0.25562 0.50576 0.0984 1.0555 3.5606h-0.83561l0.94558 0.39346-0.68166 0.0591 0.79156 0.21656 0.32986 1.2306z" />
          <path d="m17.336 163.77 0.69234-2.3762 0.72973-0.0815-0.60203-0.29378 0.93039-3.2804 0.36483 1.2077-0.29185 0.21207 0.41959 0.0816 0.87565 2.954h-0.69325l0.78448 0.32643-0.56553 0.049 0.65671 0.17966 0.27366 1.021z" />
          <path d="m19.124 163.77 0.85146-2.9224 0.89745-0.10023-0.7404-0.3613 1.1442-4.0344 0.44868 1.4853-0.35893 0.26081 0.51603 0.10036 1.0769 3.6329h-0.85259l0.96479 0.40146-0.69551 0.0603 0.80765 0.22096 0.33656 1.2556z" />
          <path d="m17.323 163.77-0.85146-2.9224-0.89745-0.10023 0.7404-0.3613-1.1442-4.0344-0.44868 1.4853 0.35893 0.26081-0.51603 0.10036-1.0769 3.6329h0.85259l-0.96479 0.40146 0.69551 0.0603-0.80765 0.22096-0.33656 1.2556z" />
          <path d="m19.065 163.77-0.56314-1.9328-0.59355-0.0663 0.48968-0.23895-0.75677-2.6683-0.29675 0.98236 0.23738 0.17249-0.34129 0.0664-0.71224 2.4027h0.56388l-0.63809 0.26552 0.45999 0.0399-0.53416 0.14614-0.22259 0.83042z" />
          <path d="m24.241 163.77-0.56314-1.9328-0.59355-0.0663 0.48968-0.23895-0.75677-2.6683-0.29675 0.98236 0.23738 0.17249-0.34129 0.0664-0.71224 2.4027h0.56388l-0.63809 0.26552 0.45999 0.0399-0.53416 0.14614-0.22259 0.83042z" />
          <path d="m33.59 163.77-0.58086-1.9936-0.61223-0.0684 0.50509-0.24647-0.78059-2.7522-0.30609 1.0133 0.24486 0.17791-0.35203 0.0685-0.73466 2.4784h0.58163l-0.65817 0.27388 0.47447 0.0412-0.55097 0.15074-0.2296 0.85656z" />
          <path d="m30.485 163.77-0.76817-2.6365-0.80966-0.0905 0.66797-0.32595-1.0323-3.6398-0.40479 1.34 0.32382 0.23528-0.46556 0.0906-0.97156 3.2775h0.76918l-0.87041 0.3622 0.62747 0.0545-0.72864 0.19935-0.30364 1.1328z" />
          <path d="m13.648 162.92-0.85146-2.9224-0.89745-0.10023 0.7404-0.3613-1.1442-4.0344-0.44868 1.4853 0.35893 0.26081-0.51603 0.10036-1.0769 3.6329h0.85259l-0.96479 0.40146 0.69551 0.0603-0.80765 0.22096-0.33656 1.2556z" />
          <path d="m10.913 162.92-1.0968-3.7645-1.1561-0.12912 0.95376-0.46541-1.474-5.197-0.57798 1.9133 0.46236 0.33597-0.66473 0.12928-1.3872 4.6798h1.0983l-1.2428 0.51714 0.89592 0.0777-1.0404 0.28463-0.43354 1.6174z" />
          <path d="m5.2503 161.91-0.42573-1.4612-0.44873-0.0501 0.3702-0.18065-0.57212-2.0172-0.22434 0.74266 0.17946 0.13041-0.25802 0.0502-0.53845 1.8165h0.42629l-0.48239 0.20073 0.34775 0.0302-0.40382 0.11048-0.16828 0.6278z" />
          <path d="m-0.34128 161.64-0.67842-2.3285-0.71506-0.0798 0.58993-0.28787-0.91169-3.2145-0.3575 1.1835 0.28598 0.20781-0.41116 0.08-0.85805 2.8946h0.67931l-0.76871 0.31987 0.55416 0.0481-0.64351 0.17606-0.26816 1.0004z" />
          <path d="m3.2992 161.64-0.90359-3.1013-0.9524-0.10629 0.78573-0.38341-1.2143-4.2814-0.47615 1.5763 0.3809 0.27679-0.54763 0.10655-1.1428 3.8553h0.90478l-1.0239 0.42603 0.73809 0.0641-0.85709 0.23449-0.35716 1.3325z" />
          <path d="m0.22982 161.64-0.44077-1.5128-0.46458-0.0518 0.38328-0.18703-0.59232-2.0884-0.23227 0.76889 0.1858 0.13502-0.26713 0.052-0.55747 1.8806h0.44135l-0.49943 0.20782 0.36004 0.0313-0.41809 0.11439-0.17422 0.64997z" />
          <path d="m4.19 161.64-0.44077-1.5128-0.46458-0.0518 0.38328-0.18703-0.59233-2.0884-0.23227 0.76889 0.1858 0.13502-0.26713 0.052-0.55747 1.8806h0.44135l-0.49943 0.20782 0.36004 0.0313-0.41809 0.11439-0.17422 0.64997z" />
          <path d="m6.7433 161.64-0.42911-1.4728-0.45229-0.0504 0.37314-0.18209-0.57666-2.0332-0.22612 0.74856 0.18089 0.13145-0.26007 0.0506-0.54273 1.8309h0.42968l-0.48623 0.20233 0.35052 0.0305-0.40703 0.11137-0.16962 0.63278z" />
          <path d="m102.46 165.91-0.29967-1.1497-0.31586-0.0395 0.26059-0.14214-0.40272-1.5872-0.15793 0.58434 0.12634 0.10265-0.18162 0.0395-0.37903 1.4293h0.30007l-0.33955 0.15793 0.24479 0.0237-0.28427 0.0869-0.11845 0.49398z" />
          <path d="m103.59 166.02-0.29967-1.1497-0.31586-0.0395 0.26059-0.14214-0.40272-1.5872-0.15793 0.58434 0.12634 0.10265-0.18162 0.0395-0.37903 1.4293h0.30007l-0.33955 0.15793 0.24479 0.0237-0.28427 0.0869-0.11845 0.49398z" />
          <path d="m104.51 166.02-0.29967-1.1497-0.31586-0.0395 0.26059-0.14214-0.40272-1.5872-0.15793 0.58434 0.12634 0.10265-0.18162 0.0395-0.37903 1.4293h0.30007l-0.33955 0.15793 0.24479 0.0237-0.28427 0.0869-0.11845 0.49397z" />
          <path d="m110.43 166.32-0.29967-1.1497-0.31586-0.0395 0.26059-0.14214-0.40272-1.5872-0.15793 0.58434 0.12634 0.10265-0.18162 0.0395-0.37903 1.4293h0.30007l-0.33955 0.15793 0.24479 0.0237-0.28427 0.0869-0.11845 0.49397z" />
          <path d="m108.48 166.32-0.29967-1.1497-0.31586-0.0395 0.26059-0.14214-0.40272-1.5872-0.15793 0.58434 0.12634 0.10265-0.18162 0.0395-0.37903 1.4293h0.30007l-0.33955 0.15793 0.24479 0.0237-0.28427 0.0869-0.11845 0.49397z" />
          <path d="m106.5 166.1-0.40675-1.396-0.42871-0.0479 0.35369-0.17261-0.54659-1.9272-0.21436 0.70954 0.17147 0.12464-0.24651 0.048-0.51444 1.7355h0.40729l-0.46088 0.19177 0.33225 0.0288-0.38583 0.10552-0.16077 0.59979z" />
          <path d="m113.06 166.39-0.58517-2.0084-0.61675-0.0689 0.50883-0.24831-0.78635-2.7726-0.30838 1.0208 0.24668 0.17932-0.35464 0.069-0.74009 2.4967h0.58594l-0.66304 0.27589 0.47799 0.0414-0.55507 0.15181-0.23129 0.86289z" />
          <path d="m117.64 166.94-0.7503-2.5751-0.79079-0.0883 0.65241-0.31838-1.0082-3.555-0.3954 1.3088 0.31629 0.22993-0.45472 0.0885-0.94893 3.2013h0.75128l-0.85014 0.35375 0.61287 0.0531-0.7117 0.19465-0.29656 1.1064z" />
          <path d="m114.39 166.5-0.3059-1.0499-0.32242-0.036 0.266-0.12981-0.41108-1.4494-0.1612 0.53362 0.12895 0.0937-0.18539 0.0361-0.38689 1.3052h0.3063l-0.34661 0.14423 0.24987 0.0216-0.29016 0.0794-0.12091 0.45108z" />
          <path d="m122.01 167.06-0.9265-3.1799-0.97654-0.10904 0.80565-0.39316-1.2451-4.3899-0.48823 1.6162 0.39056 0.28379-0.56151 0.10934-1.1718 3.9531h0.92771l-1.0498 0.43684 0.7568 0.0654-0.87883 0.24048-0.36621 1.3662z" />
          <path d="m125.52 167.06-0.9265-3.1799-0.97654-0.10904 0.80565-0.39316-1.2451-4.3899-0.48823 1.6162 0.39056 0.28379-0.56151 0.10934-1.1718 3.9531h0.92772l-1.0498 0.43684 0.7568 0.0654-0.87882 0.24048-0.36621 1.3662z" />
          <path d="m122.8 167.33-0.63395-2.1758-0.66818-0.0746 0.55125-0.26901-0.85192-3.0038-0.33407 1.1059 0.26724 0.19418-0.38421 0.0748-0.80179 2.7048h0.63478l-0.71832 0.2989 0.51783 0.0447-0.60132 0.16455-0.25058 0.93482z" />
          <path d="m127.67 167.21-0.83385-2.8619-0.87889-0.0981 0.72509-0.35385-1.1206-3.951-0.4394 1.4546 0.3515 0.25541-0.50536 0.0984-1.0546 3.5578h0.83495l-0.94483 0.39316 0.68112 0.0589-0.79094 0.21643-0.32959 1.2296z" />
          <path d="m130.75 167.31-0.83386-2.8619-0.87888-0.0981 0.72508-0.35385-1.1206-3.951-0.4394 1.4546 0.3515 0.25541-0.50536 0.0984-1.0546 3.5578h0.83495l-0.94483 0.39316 0.68112 0.0589-0.79094 0.21643-0.3296 1.2296z" />
          <path d="m133.57 167.43-1.2679-4.3516-1.3364-0.14916 1.1025-0.53803-1.7038-6.0074-0.66811 2.2117 0.53445 0.38835-0.7684 0.14962-1.6036 5.4096h1.2695l-1.4366 0.5978 1.0356 0.0896-1.2026 0.32908-0.50115 1.8696z" />
          <path d="m128.54 166.9-0.58445-2.006-0.61602-0.0688 0.50822-0.24802-0.78542-2.7692-0.30798 1.0195 0.24637 0.17902-0.35421 0.069-0.7392 2.4937h0.58522l-0.66224 0.27557 0.47741 0.0413-0.55438 0.1517-0.23101 0.86184z" />
          <path d="m136.43 167.41-0.85731-2.9424-0.90361-0.10086 0.74548-0.3638-1.1521-4.0621-0.45176 1.4955 0.36139 0.26259-0.51958 0.10117-1.0843 3.6578h0.85844l-0.97141 0.40422 0.70028 0.0606-0.81319 0.22252-0.33886 1.2642z" />
          <path d="m140.52 168.01-0.99411-3.412-1.0478-0.11696 0.86444-0.42185-1.3359-4.7103-0.52385 1.7342 0.41906 0.30449-0.60249 0.11731-1.2573 4.2416h0.99542l-1.1264 0.46872 0.81203 0.0703-0.94295 0.25803-0.39294 1.4659z" />
          <path d="m143.84 167.74-0.81969-2.8133-0.86395-0.0964 0.71276-0.34783-1.1015-3.8838-0.43193 1.4299 0.34553 0.25107-0.49678 0.0967-1.0367 3.4973h0.82076l-0.92877 0.38648 0.66954 0.058-0.7775 0.21276-0.32399 1.2087z" />
          <path d="m146.99 168.01-1.2038-4.1316-1.2688-0.14157 1.0468-0.51083-1.6177-5.7038-0.63434 2.1 0.50744 0.36872-0.72956 0.14201-1.5225 5.1362h1.2054l-1.364 0.56758 0.98331 0.0852-1.1418 0.31246-0.47582 1.7751z" />
          <path d="m152.35 168.47-1.3961-4.7918-1.4715-0.16419 1.214-0.59244-1.8762-6.6151-0.73569 2.4354 0.58852 0.42763-0.84613 0.1647-1.7658 5.9568h1.398l-1.5819 0.65826 1.1404 0.0988-1.3243 0.36238-0.55184 2.0587z" />
          <path d="m149.32 167.66-1.1241-3.858-1.1848-0.1322 0.97743-0.47699-1.5106-5.326-0.59233 1.9608 0.47384 0.34429-0.68124 0.13261-1.4217 4.796h1.1255l-1.2737 0.52998 0.91817 0.0795-1.0662 0.29176-0.4443 1.6575z" />
          <path d="m141.41 167.68-0.49706-1.706-0.52391-0.0585 0.43223-0.21092-0.66797-2.3552-0.26193 0.86709 0.20953 0.15224-0.30124 0.0586-0.62867 2.1208h0.49772l-0.56322 0.23437 0.40602 0.0352-0.47148 0.12901-0.19647 0.73297z" />
          <path d="m153.99 168.1-0.49706-1.706-0.5239-0.0585 0.43222-0.21091-0.66797-2.3552-0.26193 0.86709 0.20953 0.15225-0.30124 0.0586-0.62867 2.1208h0.49772l-0.56322 0.23435 0.40602 0.0352-0.47148 0.12901-0.19647 0.73297z" />
          <path d="m158.87 168.57-1.0455-3.5883-1.102-0.12305 0.90912-0.44364-1.405-4.9538-0.55093 1.8238 0.44072 0.32024-0.63363 0.12326-1.3223 4.4608h1.0469l-1.1846 0.49294 0.854 0.0741-0.99169 0.27132-0.41326 1.5417z" />
          <path d="m162.3 168.57-0.8345-2.8642-0.87958-0.0982 0.72565-0.35411-1.1214-3.954-0.43974 1.4557 0.35178 0.25562-0.50576 0.0984-1.0555 3.5606h0.8356l-0.94557 0.39346 0.68165 0.0591-0.79156 0.21655-0.32985 1.2306z" />
          <path d="m167.46 168.95-0.36746-1.2612-0.38731-0.0432 0.31954-0.15593-0.49382-1.7411-0.19363 0.64101 0.15489 0.11255-0.22269 0.0433-0.46475 1.5678h0.36794l-0.41637 0.17325 0.30016 0.026-0.34856 0.0954-0.14524 0.54187z" />
          <path d="m166.69 168.86-0.85147-2.9224-0.89745-0.10023 0.7404-0.3613-1.1442-4.0344-0.44868 1.4853 0.35892 0.26081-0.51603 0.10036-1.0769 3.6329h0.85259l-0.96479 0.40146 0.69551 0.0603-0.80765 0.22096-0.33656 1.2556z" />
          <path d="m166.75 168.92 0.56314-1.9328 0.59355-0.0663-0.48968-0.23895 0.75677-2.6683 0.29674 0.98236-0.23738 0.17249 0.34129 0.0664 0.71224 2.4027h-0.56388l0.63809 0.26552-0.45999 0.0399 0.53415 0.14614 0.22259 0.83042z" />
          <path d="m161.58 168.86 0.56314-1.9328 0.59355-0.0663-0.48968-0.23895 0.75677-2.6683 0.29674 0.98236-0.23738 0.17249 0.34129 0.0664 0.71224 2.4027h-0.56388l0.63808 0.26552-0.45998 0.0399 0.53415 0.14614 0.22259 0.83042z" />
          <path d="m152.23 168.47 0.58086-1.9936 0.61223-0.0684-0.50509-0.24647 0.78058-2.7522 0.30609 1.0133-0.24486 0.17791 0.35204 0.0685 0.73466 2.4784h-0.58163l0.65817 0.27388-0.47447 0.0412 0.55097 0.15074 0.2296 0.85656z" />
          <path d="m155.33 168.86 0.76817-2.6365 0.80966-0.0905-0.66797-0.32595 1.0323-3.6398 0.40479 1.34-0.32381 0.23528 0.46555 0.0906 0.97156 3.2775h-0.76918l0.87041 0.3622-0.62747 0.0545 0.72864 0.19935 0.30363 1.1328z" />
        </g>
      </g>
    </svg>
  )

  return (
    <div className={styles.container}>
      <svg className={styles.svg} xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
        <linearGradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop ref={zenithStopRef} offset="0%" id="zenith" />
          <stop ref={horizonStopRef} offset="100%" id="horizon" />
        </linearGradient>
        <rect id="sky" x="0" y="0" width="100%" height="100%" fill="url(#skyGradient)" />
      </svg>
      <div ref={sunRef} className={styles.sun}>
        <svg width="10vw" viewBox="0 0 2 2">
          <circle r="1" cx={1} cy={1} fill="#ffd"></circle>
        </svg>
      </div>
      <div ref={moonRef} className={styles.moon}>
        <svg width="4vw" viewBox="0 0 2 2">
          <circle r="0.5" cx={1} cy={1} fill="white"></circle>
        </svg>
      </div>
      <div className={styles.ground}>{ground}</div>

      {/* <div className={styles.temporary}>
        <h2>{current?.condition.text}</h2>
        <div>Clouds (prop to number of clouds): {current?.cloud}</div>
        <div>Wind speed (tree animation amplitude): {current?.wind_kph}</div>
        <div>Visibility (fog): {current?.vis_km}</div>

        <hr />
        <div>Sunrise: {forecast?.forecastday[0].astro.sunrise}</div>
        <div>Sunset: {forecast?.forecastday[0].astro.sunset}</div>
        <div>Sun up: {forecast?.forecastday[0].astro.is_sun_up}</div>

        <hr />
        <div>Moonrise: {forecast?.forecastday[0].astro.moonrise}</div>
        <div>Moonset: {forecast?.forecastday[0].astro.moonset}</div>
        <div>Moon up: {forecast?.forecastday[0].astro.is_moon_up}</div>
        <div>Moon phase: {forecast?.forecastday[0].astro.moon_phase}</div>
        <div>
          {hours.prev.time} {hours.current.time}
          <div>{hours.current.time - hours.prev.time}</div>
          <div>Sunrise {hours.current.sunrise}</div>
          <div>Sunset {hours.current.sunset}</div>
          <div>Moonrise {forecast?.forecastday[0].astro.moonrise.includes("AM")}</div>
          <div>Moonset {forecast?.forecastday[0].astro.moonset}</div>
        </div>
      </div> */}
    </div>
  )
}
